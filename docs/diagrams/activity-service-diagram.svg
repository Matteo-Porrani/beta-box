<svg viewBox="0 0 900 700" xmlns="http://www.w3.org/2000/svg" style="background-color: #ffffff;">
  <!-- Title -->
  <text x="450" y="30" font-family="monospace" font-size="18" font-weight="bold" text-anchor="middle" fill="#1f2937">
    ActivitySrv.js - Service Architecture and Data Flow
  </text>

  <!-- External Dependencies -->
  <rect x="50" y="60" width="120" height="80" fill="#f0fdf4" stroke="#374151" stroke-width="2"/>
  <text x="110" y="85" font-family="monospace" font-size="12" text-anchor="middle" fill="#1f2937">External Deps</text>
  <text x="110" y="105" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">store</text>
  <text x="110" y="120" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">moment</text>
  <text x="110" y="135" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">DateHelperSrv</text>

  <!-- WeekSrv -->
  <rect x="200" y="60" width="100" height="60" fill="#fefce8" stroke="#374151" stroke-width="2"/>
  <text x="250" y="85" font-family="monospace" font-size="12" text-anchor="middle" fill="#1f2937">WeekSrv</text>
  <text x="250" y="105" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">getWeekLimitsById</text>

  <!-- ActivitySrv Main Class -->
  <rect x="350" y="160" width="200" height="120" fill="#e0f2fe" stroke="#374151" stroke-width="2"/>
  <text x="450" y="185" font-family="monospace" font-size="14" font-weight="bold" text-anchor="middle" fill="#1f2937">ActivitySrv</text>
  <text x="450" y="205" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">(Singleton Pattern)</text>
  <text x="450" y="225" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">Public Methods:</text>
  <text x="450" y="240" font-family="monospace" font-size="9" text-anchor="middle" fill="#1f2937">getActivitiesByWeekId()</text>
  <text x="450" y="255" font-family="monospace" font-size="9" text-anchor="middle" fill="#1f2937">getActivitiesByRange()</text>
  <text x="450" y="270" font-family="monospace" font-size="9" text-anchor="middle" fill="#1f2937">getLabelFromActivityCode()</text>

  <!-- Private Methods -->
  <rect x="100" y="320" width="150" height="100" fill="#f3e8ff" stroke="#374151" stroke-width="2"/>
  <text x="175" y="345" font-family="monospace" font-size="12" text-anchor="middle" fill="#1f2937">Data Retrieval</text>
  <text x="175" y="365" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">#getDaysOnPeriod()</text>
  <text x="175" y="380" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">#hydrateDays()</text>
  <text x="175" y="395" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_hydrateActivities()</text>
  <text x="175" y="410" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_getTicketInfo()</text>

  <!-- Utility Methods -->
  <rect x="280" y="320" width="150" height="100" fill="#fdf2f8" stroke="#374151" stroke-width="2"/>
  <text x="355" y="345" font-family="monospace" font-size="12" text-anchor="middle" fill="#1f2937">Utility Methods</text>
  <text x="355" y="365" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_formatDuration()</text>
  <text x="355" y="380" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_formatDate()</text>
  <text x="355" y="395" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_calculateTotalDuration()</text>
  <text x="355" y="410" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_parseTypesBar()</text>

  <!-- Parsing Methods -->
  <rect x="460" y="320" width="150" height="100" fill="#fff7ed" stroke="#374151" stroke-width="2"/>
  <text x="535" y="345" font-family="monospace" font-size="12" text-anchor="middle" fill="#1f2937">Type Processing</text>
  <text x="535" y="365" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_isCurrentDay()</text>
  <text x="535" y="380" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">_sumActivitiesByType()</text>
  <text x="535" y="395" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">Handles: $D, $R, $O,</text>
  <text x="535" y="410" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">$A, $E types</text>

  <!-- Data Store -->
  <rect x="650" y="160" width="150" height="120" fill="#f0fdf4" stroke="#374151" stroke-width="2"/>
  <text x="725" y="185" font-family="monospace" font-size="12" text-anchor="middle" fill="#1f2937">Vuex Store</text>
  <text x="725" y="205" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">Tables:</text>
  <text x="725" y="220" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">- day</text>
  <text x="725" y="235" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">- activity</text>
  <text x="725" y="250" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">- ticket</text>
  <text x="725" y="265" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">- $activity_type</text>

  <!-- Data Flow Output -->
  <rect x="300" y="480" width="300" height="120" fill="#e0f2fe" stroke="#374151" stroke-width="2"/>
  <text x="450" y="505" font-family="monospace" font-size="12" text-anchor="middle" fill="#1f2937">Final Output Structure</text>
  <text x="450" y="525" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">{</text>
  <text x="450" y="540" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">  date, id, isCurrentDay, formattedDate,</text>
  <text x="450" y="555" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">  totalDuration, activities[], parts{}</text>
  <text x="450" y="570" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">  activities include: ticketInfo[]</text>
  <text x="450" y="585" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">}</text>

  <!-- Arrows -->
  <!-- WeekSrv to ActivitySrv -->
  <path d="M300 90 L320 90 L320 200 L350 200" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- External Deps to ActivitySrv -->
  <path d="M170 120 L300 120 L300 180 L350 180" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- ActivitySrv to Private Methods -->
  <path d="M380 280 L380 300 L220 300 L220 320" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M420 280 L420 300 L355 300 L355 320" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M460 280 L460 300 L535 300 L535 320" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- ActivitySrv to Store -->
  <path d="M550 220 L600 220 L600 220 L650 220" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Private Methods to Output -->
  <path d="M220 420 L220 450 L380 450 L380 480" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M355 420 L355 450 L450 450 L450 480" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M535 420 L535 450 L520 450 L520 480" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
  </defs>

  <!-- Summary -->
  <rect x="50" y="630" width="800" height="60" fill="#f9fafb" stroke="#374151" stroke-width="1"/>
  <text x="450" y="650" font-family="monospace" font-size="12" font-weight="bold" text-anchor="middle" fill="#1f2937">Summary</text>
  <text x="450" y="670" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">
    ActivitySrv manages activity data by fetching from Vuex store, hydrating with ticket info,
  </text>
  <text x="450" y="685" font-family="monospace" font-size="10" text-anchor="middle" fill="#1f2937">
    formatting durations/dates, calculating totals, and parsing activity type percentages for visualization.
  </text>
</svg>